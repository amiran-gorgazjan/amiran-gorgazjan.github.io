var f0=Object.defineProperty;var v0=(_,J)=>{for(var Q in J)f0(_,Q,{get:J[Q],enumerable:!0,configurable:!0,set:(Z)=>J[Q]=()=>Z})};var S=(_,J)=>()=>(_&&(J=_(_=0)),J);var k,R,h,b,D,Q1,Z1,z1,V1,p,P1,l,k1;var u=S(()=>{k=80,R=24,h=-1,b=0,D=1,Q1=2,Z1=3,z1=4,V1=5,p=6,P1=7,l=8,k1=9});function T(_=h){return Array.from({length:R*k},()=>_)}function M1(_,J){return _<0||_>=k||J<0||J>=R}function W(_,J,Q){if(M1(J,Q))return;return _[Q*k+J]}function U(_,J,Q,Z){if(M1(J,Q))return;_[Q*k+J]=Z}function q0(_=[]){if(_.length===0)return console.warn("No layers to merge"),[];const J=T();for(let Q of _)for(let Z=0;Z<Q.length;Z++)if(Q[Z]!==h)J[Z]=Q[Z];return J}var c=S(()=>{u()});function B(_,J,Q=1){return{"@type":"style",glyph:_,color:J,opacity:Q}}function i0(_){if(typeof _!=="string"&&typeof _!=="number")return!1;return _ in q1}function b1(_){if(o0(_))return _;if(!i0(_))return b1("UNKNOWN");return q1[_]}function x1(_,J,Q,Z=5){for(let z=0;z<360;z+=1){const q=Math.cos(z*Math.PI/180),F=Math.sin(z*Math.PI/180);let j=Q.x+0.5,$=Q.y+0.5;for(let G=0;G<Z;G+=0.1){j+=q*0.1,$+=F*0.1;const H=Math.floor(j),w=Math.floor($);if(H>=0&&H<k&&w>=0&&w<R&&W(J,H,w)===D){U(_,H,w,h);break}if(H>=0&&H<k&&w>=0&&w<R)U(_,H,w,h)}}}function j0(_=[],J=null){const Q=q0(_);let Z=[];for(let z=0;z<R;z++){let q="",F=null,j=null;for(let $=0;$<k;$++){const G=W(Q,$,z);if(G===void 0)throw new Error(`Value at ${$}, ${z} is undefined`);let H=b1(G);const w=J?W(J,$,z):h,I={...H,opacity:w===l?0.2:1};if(!I)throw new Error(`Unknown graphic: ${G}`);if(I.color!==F||I.opacity!==j){if(F!==null)q+="</span>";q+=`<span style="color: ${I.color}; opacity: ${I.opacity}">`}F=I.color,j=I.opacity,q+=I.glyph}if(F!==null)q+="</span>";Z.push(q)}return Z}var o0,q1;var m1=S(()=>{u();c();o0=function(_){return typeof _==="object"&&_!==null&&("@type"in _)&&_["@type"]==="style"};q1={UNKNOWN:B("\uFFFD","#fff"),[h]:B(" ","transparent"),[b]:B("\u2591","#333"),[D]:B("\u2588","#ccc"),[Q1]:B("\u2193","#777"),[Z1]:B("\u2191","#ff0"),[z1]:B("\u263A","#ff0"),[V1]:B("\u10E2","#f00"),[p]:B("\u03A8","#f00"),[P1]:B("$","#ff0"),[l]:B(" ","#222"),[k1]:B("S","#0ff"),"\u25AB":B("\u2588","#ccc"),"\u2554":B("\u2554","#ccc"),"\u2557":B("\u2557","#ccc"),"\u255A":B("\u255A","#ccc"),"\u255D":B("\u255D","#ccc"),"\u2566":B("\u2566","#ccc"),"\u2569":B("\u2569","#ccc"),"\u2560":B("\u2560","#ccc"),"\u2563":B("\u2563","#ccc"),"\u256C":B("\u256C","#ccc"),"\u2550":B("\u2550","#ccc"),"\u2551":B("\u2551","#ccc"),"\u2568":B("\u2568","#ccc"),"\u2565":B("\u2565","#ccc"),"\u255E":B("\u255E","#ccc"),"\u2561":B("\u2561","#ccc")}});function F0(_){return _ in u1}var I1,j1,u1;var B0=S(()=>{I1=(_=1,J=1,Q={})=>{return{onAttack:{hp:_,radius:J,sound:null,...Q}}},j1=(_,J,Q,Z={})=>({...Z,glyph:_,name:J,description:Q}),u1={apple:j1("\uD83C\uDF4E","Apple","A delicious apple",{onUse:{hp:1,sound:"apple-bite-1"},...I1(1)}),"health-potion":j1("\uD83E\uDDEA","Health potion","A potion that heals you",{onUse:{hp:5,sound:"apple-bite-1"}}),"gold-coin":j1("\uD83D\uDCB0","Gold coin","A shiny gold coin",{...I1(0.5)}),"wooden-sword":j1("\uD83D\uDDE1","Wooden sword","A dull wooden sword that does not look very dangerous",{...I1(3)}),bomb:j1("\uD83D\uDCA3","Bomb","A dangerous bomb",{...I1(10,3)})}});var K0,F1,W0,B1,d1,p1,X0,$0;var c1=S(()=>{c();u();B0();m1();K0=function(_={}){return Object.assign(Object.fromEntries(Object.keys(u1).map((J)=>{return[J,0]})),_)},F1=function(){return{position:{x:0,y:0},health:10,maxHealth:10,damage:1,luck:0.2,visibility:8,inventory:K0(),style:B("\u263A","#ff0")}},W0=function(){return{...F1(),health:3,maxHealth:3,damage:1,visibility:7,inventory:K0({"gold-coin":1+Math.floor(Math.random()*4),apple:Math.floor(Math.random()*3)}),style:B("\u03A8","#f00")}},B1=function(_,J){_.position.x=J.x,_.position.y=J.y},d1=function(_,J,Q){const Z=J.position.x+Q.x,z=J.position.y+Q.y;if(W(_,Z,z)!==b)return!1;return B1(J,{x:Z,y:z}),!0},p1=function(_,J,Q){const Z=J.position.x+Q.x,z=J.position.y+Q.y;for(let q of _)if(q.position.x===Z&&q.position.y===z){if(q.health-=J.damage,q.health<=0)q.health=0,console.log("killed",q),console.log("inventory",q.inventory),Object.entries(q.inventory).forEach(([F,j])=>{if(F0(F)){if(J.inventory[F]===void 0)J.inventory[F]=0;J.inventory[F]+=j}});return!0}return!1},X0=function(_,J,Q){const Z=Math.sqrt(Math.pow(J.position.x-_.position.x,2)+Math.pow(J.position.y-_.position.y,2));if(Z>_.visibility)return!1;const z=J.position.x-_.position.x,q=J.position.y-_.position.y,F=Math.atan2(q,z);for(let j=0;j<Z;j+=0.1){const $=Math.floor(_.position.x+Math.cos(F)*j),G=Math.floor(_.position.y+Math.sin(F)*j);if(W(Q,$,G)!==b)return!1}return!0},$0=function(_,J){const Q=J.position.x-_.position.x,Z=J.position.y-_.position.y;if(Math.abs(Q)>Math.abs(Z))return{x:Math.sign(Q),y:0};else return{x:0,y:Math.sign(Z)}}});function G0(){const _=T(D);let J=Math.floor(Math.random()*k),Q=Math.floor(Math.random()*R),Z=J,z=Q;U(_,Z,z,b);let q=0,F=1000,j=null;const $=Math.random();while(!0){const G=n0(j,$),H=Z+G.x,w=z+G.y;if(H>=1&&H<k-1&&w>=1&&w<R-1){if(Z=H,z=w,U(_,Z,z,b),++q>=F)break;if(Math.abs(Z-J)>=k*0.8)break}j=G}while(l0(_)>0)continue;return{layer:_,start:{x:J,y:Q},end:{x:Z,y:z}}}function l0(_){let J=0;for(let Q=1;Q<k-1;Q++)for(let Z=1;Z<R-1;Z++)if(W(_,Q,Z)===D){if([W(_,Q,Z-1),W(_,Q,Z+1),W(_,Q-1,Z),W(_,Q+1,Z)].filter((F)=>F===D).length<=1)U(_,Q,Z,b),J++}return J}function n0(_,J=0.5){if(_&&Math.random()>J)return _;let Q=r0.filter((Z)=>{if(!_)return!0;return Z.x!==-_.x&&Z.y!==-_.y});return Q[Math.floor(Math.random()*Q.length)]}var r0,U0,H0;var w0=S(()=>{c1();c();u();r0=[{x:-1,y:0},{x:1,y:0},{x:0,y:-1},{x:0,y:1}],U0=(_,J,Q,Z)=>Math.abs(Q-_)+Math.abs(Z-J),H0=function(_,J=1){const q=[];for(let F=0;F<50;F++){const j=Math.floor(Math.random()*k),$=Math.floor(Math.random()*R);if(W(_.layer,j,$)===b){const G=U0(j,$,_.start.x,_.start.y);let H=!0;for(let w of q)if(U0(j,$,w.position.x,w.position.y)<5||G<10){H=!1;break}if(H){const w=W0();B1(w,{x:j,y:$}),q.push(w)}}}return q}});function O0(_,J,Q,{pathTile:Z=b,wallTile:z=D}={}){const q=[..._];K1(q,J,Q);for(let F=0;F<q.length;F++)if(q[F]===z)q[F]=Z;for(let F=0;F<q.length;F++)if(q[F]==="VISITED")q[F]=_[F];return q}var K1;var Y0=S(()=>{u();c();K1=function(_,J,Q,{pathTile:Z=b,wallTile:z=D}={}){if(M1(J,Q))return;U(_,J,Q,"VISITED");const q=W(_,J,Q-1),F=W(_,J+1,Q),j=W(_,J,Q+1),$=W(_,J-1,Q),G=W(_,J-1,Q-1),H=W(_,J+1,Q-1),w=W(_,J+1,Q+1),I=W(_,J-1,Q+1);if(q===z)U(_,J,Q-1,"VISITED");if(F===z)U(_,J+1,Q,"VISITED");if(j===z)U(_,J,Q+1,"VISITED");if($===z)U(_,J-1,Q,"VISITED");if(G===z)U(_,J-1,Q-1,"VISITED");if(H===z)U(_,J+1,Q-1,"VISITED");if(w===z)U(_,J+1,Q+1,"VISITED");if(I===z)U(_,J-1,Q+1,"VISITED");if(q===Z)K1(_,J,Q-1);if(F===Z)K1(_,J+1,Q);if(j===Z)K1(_,J,Q+1);if($===Z)K1(_,J-1,Q)}});function V0(_){const J=T(h);for(let Q=0;Q<R;Q++)for(let Z=0;Z<k;Z++){if(W(_,Z,Q)!==D)continue;const q=W(_,Z,Q-1),F=W(_,Z,Q+1),j=W(_,Z-1,Q),$=W(_,Z+1,Q),G=[q,j,$,F].join(""),H=e0[G];if(H)U(J,Z,Q,`${H}`);else U(J,Z,Q,`${a0}`)}return J}var a0,K,X,t0,e0;var P0=S(()=>{u();c();a0="\u25AB",K=D,X=b,t0={"\u2554":[X,X,K,K],"\u2557":[X,K,X,K],"\u255A":[K,X,K,X],"\u255D":[K,K,X,X],"\u2566":[X,K,K,K],"\u2569":[K,K,K,X],"\u2560":[K,X,K,K],"\u2563":[K,K,X,K],"\u256C":[K,K,K,K],"\u2550":[X,K,K,X],"\u2551":[K,X,X,K],"\u2568":[K,X,X,X],"\u2565":[X,X,X,K],"\u255E":[X,X,K,X],"\u2561":[X,K,X,X]},e0=Object.fromEntries(Object.entries(t0).map(([_,J])=>[J.join(""),_]))});function M0(){return Promise.all(Object.values(k0).map((_)=>{return _5(_.url).then((J)=>{_.buffer=J})}))}function r(_){const J=k0[_];if(!J){console.warn(`Sound ${_} not found`);return}const Q=y1.createBufferSource();Q.buffer=J.buffer,Q.connect(y1.destination),Q.loop=!1,Q.start(Q.context.currentTime)}var W1,_5,k0,y1;var b0=S(()=>{W1=function(_,J){return{url:`/modules/games/koobas/audio-player/files/${_}.${J}`,buffer:null}},_5=function(_){return new Promise((J,Q)=>{const Z=new XMLHttpRequest;Z.open("GET",_,!0),Z.responseType="arraybuffer",Z.onload=function(){y1.decodeAudioData(Z.response,function(z){J(z)},Q)},Z.onerror=Q,Z.send()})};k0={punch1:W1("punch1","wav"),"apple-bite-1":W1("apple-bite-1","mp3"),"player-death":W1("player-death","wav"),step:W1("step","wav"),ascend:W1("ascend","wav")},y1=new AudioContext});var I0={};v0(I0,{main:()=>{{return z5}}});function z5(_){return new Promise(async(J,Q)=>{const{print:Z,clear:z}=_;Z("Loading..."),z(),await M0(),Y=F1(),R1=0,s1({..._,resolve:J,reject:Q})})}var J5,s1,Q5,Z5,Y,R1;var R0=S(()=>{m1();c1();c();w0();Y0();u();P0();b0();J5=function(_){return[`Health ${_.health}`,`Apples ${_.inventory.apple}`,`Gold ${_.inventory["gold-coin"]}`].join("  ")},s1=function(_){const{print:J,optimisedDangerousLinePrint:Q,terminalEl:Z,shake:z,resolve:q,reject:F}=_,j=G0(),$=T();let G=H0(j,R1);B1(Y,j.start),U($,j.start.x,j.start.y,Q1),U($,j.end.x,j.end.y,Z1);const H=V0(O0(j.layer,j.start.x,j.start.y)),w=T(l);function I(){if(Y===null)throw new Error("Player is null");x1(w,j.layer,Y.position,Y.visibility);const P=T(l);x1(P,j.layer,Y.position,Y.visibility);const d=T();U(d,Y.position.x,Y.position.y,z1);for(let C of G)U(d,C.position.x,C.position.y,C.style??p);const f=j0([j.layer,H,$,d,w],P);Q([J5(Y),...f,Z5])}function L0(){Y=F1(),R1=0,r("player-death"),N1(),s1(_)}function h0(){R1+=1,r("ascend"),N1(),s1(_)}function T0(P){P.health=Math.min(P.health+3,P.maxHealth),P.inventory.apple-=1,r("apple-bite-1")}function i1(P){if(P.key==="c"&&P.ctrlKey)return P.preventDefault(),J("^C"),E0();let d=!1,f=null;if(P.key==="ArrowLeft")f={x:-1,y:0};else if(P.key==="ArrowRight")f={x:1,y:0};else if(P.key==="ArrowUp")f={x:0,y:-1};else if(P.key==="ArrowDown")f={x:0,y:1};if(P.key==="a"){if(P.preventDefault(),Y.inventory.apple>0)d=!0,T0(Y)}if(f){if(P.preventDefault(),d=!0,!p1(G,Y,f))d1(j.layer,Y,f),r("step");else r("punch1"),z();if(Y.position.x===j.end.x&&Y.position.y===j.end.y){h0();return}G=G.filter(($1)=>$1.health>0)}if(d){for(let C of G)if(X0(C,Y,j.layer)){C.style=B(q1[p].glyph,"#ff0000");const $1=$0(C,Y);if(!p1([Y],C,$1))d1(j.layer,C,$1)}else C.style=B(q1[p].glyph,"#aa0000");if(Y.health<=0){L0();return}}I()}function N1(){Z.removeEventListener("keydown",i1)}function E0(){N1(),q()}Z.addEventListener("keydown",i1),I()};Q5={[Z1]:"Exit",[Q1]:"Entrance",[z1]:"You",[V1]:"Apple",[p]:"Monster",[P1]:"Gold",[k1]:"Shop"},Z5=Object.entries(Q5).map(([_,J])=>`${b1(_).glyph} ${J}`).join("  "),Y=F1(),R1=0});var H1=function(){throw new Error("Cycle detected")},g0=function(){throw new Error("Computed cannot have side-effects")},A1=function(){U1++},L1=function(){if(U1>1){U1--;return}let _,J=!1;while(t!==void 0){let Q=t;t=void 0,S1++;while(Q!==void 0){const Z=Q._nextBatchedEffect;if(Q._nextBatchedEffect=void 0,Q._flags&=~s,!(Q._flags&o)&&r1(Q))try{Q._callback()}catch(z){if(!J)_=z,J=!0}Q=Z}}if(S1=0,U1--,J)throw _};var l1=function(_){if(O===void 0)return;let J=_._node;if(J===void 0||J._target!==O){if(J={_version:0,_source:_,_prevSource:O._sources,_nextSource:void 0,_target:O,_prevTarget:void 0,_nextTarget:void 0,_rollbackNode:J},O._sources!==void 0)O._sources._nextSource=J;if(O._sources=J,_._node=J,O._flags&g)_._subscribe(J);return J}else if(J._version===-1){if(J._version=0,J._nextSource!==void 0){if(J._nextSource._prevSource=J._prevSource,J._prevSource!==void 0)J._prevSource._nextSource=J._nextSource;J._prevSource=O._sources,J._nextSource=void 0,O._sources._nextSource=J,O._sources=J}return J}return},M=function(_){this._value=_,this._version=0,this._node=void 0,this._targets=void 0},_1=function(_){return new M(_)},r1=function(_){for(let J=_._sources;J!==void 0;J=J._nextSource)if(J._source._version!==J._version||!J._source._refresh()||J._source._version!==J._version)return!0;return!1},n1=function(_){for(let J=_._sources;J!==void 0;J=J._nextSource){const Q=J._source._node;if(Q!==void 0)J._rollbackNode=Q;if(J._source._node=J,J._version=-1,J._nextSource===void 0){_._sources=J;break}}},a1=function(_){let J=_._sources,Q=void 0;while(J!==void 0){const Z=J._prevSource;if(J._version===-1){if(J._source._unsubscribe(J),Z!==void 0)Z._nextSource=J._nextSource;if(J._nextSource!==void 0)J._nextSource._prevSource=Z}else Q=J;if(J._source._node=J._rollbackNode,J._rollbackNode!==void 0)J._rollbackNode=void 0;J=Z}_._sources=Q},x=function(_){M.call(this,void 0),this._compute=_,this._sources=void 0,this._globalVersion=G1-1,this._flags=e};var t1=function(_){const J=_._cleanup;if(_._cleanup=void 0,typeof J==="function"){A1();const Q=O;O=void 0;try{J()}catch(Z){throw _._flags&=~A,_._flags|=o,h1(_),Z}finally{O=Q,L1()}}},h1=function(_){for(let J=_._sources;J!==void 0;J=J._nextSource)J._source._unsubscribe(J);_._compute=void 0,_._sources=void 0,t1(_)},m0=function(_){if(O!==this)throw new Error("Out-of-order effect");if(a1(this),O=_,this._flags&=~A,this._flags&o)h1(this);L1()},J1=function(_){this._compute=_,this._cleanup=void 0,this._sources=void 0,this._nextBatchedEffect=void 0,this._flags=g},w1=function(_){const J=new J1(_);try{J._callback()}catch(Q){throw J._dispose(),Q}return J._dispose.bind(J)},x0=Symbol.for("preact-signals"),A=1<<0,s=1<<1,e=1<<2,o=1<<3,a=1<<4,g=1<<5,O=void 0;var t=void 0,U1=0,S1=0,G1=0;M.prototype.brand=x0;M.prototype._refresh=function(){return!0};M.prototype._subscribe=function(_){if(this._targets!==_&&_._prevTarget===void 0){if(_._nextTarget=this._targets,this._targets!==void 0)this._targets._prevTarget=_;this._targets=_}};M.prototype._unsubscribe=function(_){if(this._targets!==void 0){const{_prevTarget:J,_nextTarget:Q}=_;if(J!==void 0)J._nextTarget=Q,_._prevTarget=void 0;if(Q!==void 0)Q._prevTarget=J,_._nextTarget=void 0;if(_===this._targets)this._targets=Q}};M.prototype.subscribe=function(_){const J=this;return w1(function(){const Q=J.value,Z=this._flags&g;this._flags&=~g;try{_(Q)}finally{this._flags|=Z}})};M.prototype.valueOf=function(){return this.value};M.prototype.toString=function(){return this.value+""};M.prototype.toJSON=function(){return this.value};M.prototype.peek=function(){return this._value};Object.defineProperty(M.prototype,"value",{get(){const _=l1(this);if(_!==void 0)_._version=this._version;return this._value},set(_){if(O instanceof x)g0();if(_!==this._value){if(S1>100)H1();this._value=_,this._version++,G1++,A1();try{for(let J=this._targets;J!==void 0;J=J._nextTarget)J._target._notify()}finally{L1()}}}});x.prototype=new M;x.prototype._refresh=function(){if(this._flags&=~s,this._flags&A)return!1;if((this._flags&(e|g))===g)return!0;if(this._flags&=~e,this._globalVersion===G1)return!0;if(this._globalVersion=G1,this._flags|=A,this._version>0&&!r1(this))return this._flags&=~A,!0;const _=O;try{n1(this),O=this;const J=this._compute();if(this._flags&a||this._value!==J||this._version===0)this._value=J,this._flags&=~a,this._version++}catch(J){this._value=J,this._flags|=a,this._version++}return O=_,a1(this),this._flags&=~A,!0};x.prototype._subscribe=function(_){if(this._targets===void 0){this._flags|=e|g;for(let J=this._sources;J!==void 0;J=J._nextSource)J._source._subscribe(J)}M.prototype._subscribe.call(this,_)};x.prototype._unsubscribe=function(_){if(this._targets!==void 0){if(M.prototype._unsubscribe.call(this,_),this._targets===void 0){this._flags&=~g;for(let J=this._sources;J!==void 0;J=J._nextSource)J._source._unsubscribe(J)}}};x.prototype._notify=function(){if(!(this._flags&s)){this._flags|=e|s;for(let _=this._targets;_!==void 0;_=_._nextTarget)_._target._notify()}};x.prototype.peek=function(){if(!this._refresh())H1();if(this._flags&a)throw this._value;return this._value};Object.defineProperty(x.prototype,"value",{get(){if(this._flags&A)H1();const _=l1(this);if(this._refresh(),_!==void 0)_._version=this._version;if(this._flags&a)throw this._value;return this._value}});J1.prototype._callback=function(){const _=this._start();try{if(this._flags&o)return;if(this._compute===void 0)return;const J=this._compute();if(typeof J==="function")this._cleanup=J}finally{_()}};J1.prototype._start=function(){if(this._flags&A)H1();this._flags|=A,this._flags&=~o,t1(this),n1(this),A1();const _=O;return O=this,m0.bind(this,_)};J1.prototype._notify=function(){if(!(this._flags&s))this._flags|=s,this._nextBatchedEffect=t,t=this};J1.prototype._dispose=function(){if(this._flags|=o,!(this._flags&A))h1(this)};var v=_1("/srv/public"),m=_1("amiran"),L=_1(""),O1=_1(!0);var V=function(_){return{type:"folder",files:_}},N=function(_){return{type:"file",content:_}},u0=function(_){return{type:"executable",fn:_}},T1=function(_){const J={};for(let Q of _)J[Q]=u0(()=>{return{error:"Access denied"}});return V(J)},y0=function(_){if(_=_.trim(),_.startsWith("~"))_="/home/user"+_.substring(1);if(_.endsWith("/"))_=_.substring(0,_.length-1);const J=_.split("/"),Q=[];for(let z of J)if(z===".."){if(Q.length>0)Q.pop()}else if(z!=="."&&z!=="")Q.push(z);return(_.startsWith("/")?"/":"")+Q.join("/")},e1=function(_){const J=_.startsWith("/")?_:v.value+"/"+_;return y0(J)},Y1=function(_){const J=e1(_);let Q=E1[m.value].root;if(J==="/")return Q;const Z=J.split("/").slice(1);for(let z of Z){if(!Q.files[z])return null;Q=Q.files[z]}return Q},s0=function(_){const J=Y1(_);if(!J)return{error:"no such file or directory: "+_};if(J.type!=="folder")return{error:"not a directory: "+_};return v.value=e1(_),{success:!0}};function _0(_){const J=Y1(v.value);if(!J)return null;const Z=Object.keys(J.files).sort().find((z)=>z.startsWith(_));if(!Z)return null;return Z.substring(_.length)}var d0={bin:T1(["cat","chmod","cd","cp","date","echo","ftp","grep","head","ls","lpr","more","mkdir","mv","ncftp","print","pwd","rm","rmdir","rsh","setenv","sort","tail","tar","telnet","wc"].toSorted()),etc:V({hosts:N("")}),tmp:V({}),var:V({}),usr:V({local:V({bin:T1(["git","node","npm","yarn","email","calendar","calculator","clock","weather","news","music","video","image"].toSorted())}),bin:T1(["vim","nano","emacs","code","subl"])})},f1=V({...d0,home:V({amiran:V({"notes.txt":N("Hello world")})}),srv:V({public:V({"index.html":N("<h1>Hello world</h1>"),pages:V({"projects.html":N("<h1>Projects</h1>"),"cv.html":N("<h1>CV</h1>")}),posts:V({"uvicorn vs gunicorn.html":N("<h1>Hello world</h1>"),"signal based entity system.html":N("<h1>Hello world</h1>"),"the power of useSelector.html":N("<h1>Hello world</h1>"),"defeating procrastination - an essay.html":N("<h1>Hello world</h1>")})})})}),p0=V({...f1,home:V({jamie:V({"notes.txt":N("Hello world from Jamie!")})})}),c0=V({...f1,home:V({jamie:V({"notes.txt":N("Hello world from Jamie!")})})}),E1={amiran:{root:f1,password:null},jamie:{root:p0,password:"ayylmao"},maria:{root:c0,password:"ayylmao"}},J0={cwd:{description:"Print the current working directory",exec:({print:_})=>{_(v.value)}},ls:{description:"List files and directories",exec:({print:_})=>{const J=Y1(v.value);if(!J){_("Current folder does not exist.");return}if(J.type!=="folder"){_("Path is not a folder");return}_(".\n.."),Object.keys(J.files).forEach((Q)=>{if(J.files[Q].type==="folder")_(Q+"/");else _(Q)})}},cd:{description:"Change directory",exec:({print:_,params:J})=>{const Q=J[0];if(!Q){_("cd: path missing");return}const Z=s0(Q);if(Z.error)_("cd: "+Z.error)}},cat:{description:"Print file contents",exec:({print:_,params:J})=>{const Q=J[0];if(!Q){_("cat: path missing");return}const Z=Y1(Q);if(!Z){_("cat: "+Q+": No such file or directory");return}if(Z.type!=="file"){_("cat: "+Q+": Is a directory");return}_(Z.content)}},telnet:{description:"Connect to a remote machine",exec:({print:_,params:J})=>{const Q=J[0];if(!Q){_("telnet: machine missing");return}if(!E1[Q]){_("telnet: machine not found");return}m.value=Q,_(`Connected to "${Q}". Type "quit" to disconnect.`),v.value="/"}},quit:{description:"Disconnect from the current machine",exec:({print:_})=>{if(m.value==="amiran"){_("You cannot disconnect from the local machine");return}_(`Disconnected from remote host "${m.value}"`),m.value="amiran"}},nmap:{description:"List all machines on the network",exec:({print:_})=>{_(Object.entries(E1).map(([J,{password:Q}])=>{return J+(Q?" (password protected)":"")}).join("\n"))}}};var Q0=function(_){return _.trim().split("\n").map((J)=>J.trim()).join("\n")},Z0=function(_,J){return _.split("\n").map((Q)=>J+Q).join("\n")},i=function(_,J){return _+" ".repeat(Math.max(J-_.length,0))},v1=[{id:1,from:"InfoSec <infosec@talesprout.com>",time:"2020-01-01 12:14:23",subject:"Password Reset",body:`
            Hey Amiran!

            This is Maria from InfoSec. We've recently noticed some suspicious
            activity on your account. We've reset your password to prevent any
            unauthorized access.
            
            The new password is: ayylmao123
            Please change it as soon as possible.

            I also noticed that you haven't added a password to your machine.
            Please add a password to your machine to prevent unauthorized access
            to your files.

            Thanks,
            Maria (InfoSec @ Talesprout.com)
        `,response:`
            Hey Maria!

            Thanks for the heads up. I'll change my password right away.

            Amiran (CEO, Talesprout.com)
        `},{id:2,from:"Jane Doe",time:"2020-01-02 13:34:12",subject:"Hi",body:"Hi World"}],g1={description:"Check your email",commands:{list:{description:"List emails",exec:({print:_})=>{const J=v1.reduce((Z,z)=>{const{id:q,from:F,subject:j}=z;return{id:Math.max(Z.id,q.toString().length),from:Math.max(Z.from,F.length),subject:Math.max(Z.subject,j.length)}},{id:0,from:0,subject:0}),Q={id:Math.max(J.id,"ID".length),from:Math.max(J.from,"FROM".length),subject:Math.max(J.subject,"SUBJECT".length)};_(`${i("ID",Q.id)}  ${i("FROM",Q.from)}  SUBJECT`),_(`${i("-".repeat(Q.id),Q.id)}  ${i("-".repeat(Q.from),Q.from)}  ${"-".repeat(Q.subject)}`),v1.forEach((Z)=>{const{id:z,from:q,subject:F}=Z;_(`${i(z,Q.id)}   ${i(q,Q.from)}  ${F}`)})}},show:{description:"Read an email",exec:({print:_,params:J})=>{const Q=J[0],Z=v1.find((z)=>z.id===Number(Q));if(!Z){_(`Email with ID ${Q} not found`);return}if(_(`From: ${Z.from}`),_(`Date: ${Z.time}`),_(`Subject: ${Z.subject}`),_(`\n${Z0(Q0(Z.body),"")}`),Z.response)_(""),_(`${Z0(Q0(Z.response),"> ")}`)}}},exec:({print:_,params:J})=>{const Q=J[0];if(!Q||Q==="help"){_("Welcome to the inbox!"),_("Available commands:\n"),Object.entries(g1.commands).forEach(([z,{description:q}])=>{_(`    ${z} - ${q}`)});return}const Z=g1.commands[Q];if(!Z){_(`Command "${Q}" not found`);return}Z.exec({print:_,params:J.slice(1)})}},z0={email:g1};var q5={description:"A dungeon crawler game",exec:async(..._)=>{return await(await Promise.resolve().then(() => (R0(),I0))).main(..._)}},D0={koobas:q5};var A0=function(_){return _ in C1},E=document.getElementById("output"),j5=document.getElementById("prompt"),D1=document.getElementById("terminal"),o1=document.getElementById("cmd"),N0=document.getElementById("path"),y=[],n=0,F5=(_)=>{if(typeof _!=="string")try{_=JSON.stringify(_)}catch(J){_=String(_)}return _=_.replace(/</g,"&lt;").replace(/>/g,"&gt;"),_.split("\n").map((J)=>J.slice(0,80)).join("\n")},X1=(_)=>{E.innerHTML+=F5(_)+"\n",E.scrollTop=E.scrollHeight},B5=(_,{replace:J=!1}={})=>{if(J)E.innerHTML=_;else E.innerHTML+=_;setTimeout(()=>{E.scrollTop=E.scrollHeight},100)},C0=[],K5=(_=[])=>{_.forEach((J,Q)=>{if(C0[Q]===J)return;const Z=E.querySelector(`#line-${Q}`);if(Z)Z.innerHTML=J;else E.innerHTML+=`<div id="line-${Q}">${J}</div>`;C0[Q]=J})},W5=()=>{D1.classList.add("shake"),setTimeout(()=>{D1.classList.remove("shake")},100)},S0=()=>E.textContent="",C1={help:{description:"List all available commands",exec:({print:_})=>{Object.keys(C1).filter(A0).forEach((J)=>{const Q=C1[J].description;_(`${J} - ${Q}`)})}},clear:{description:"Clear the terminal screen",exec:S0},history:{description:"List all commands executed in this session",exec:({print:_})=>{y.forEach((J)=>{_(J)})}},...J0,...z0,...D0},X5=async(_)=>{const J=_.trim().split(" "),Q=J[0],Z=J.slice(1).filter((z)=>z!=="");if(A0(Q)){const z=o1.style.display;o1.style.display="none",O1.value=!1;try{await C1[Q].exec({print:X1,clear:S0,dangerouslyPrintHTML:B5,optimisedDangerousLinePrint:K5,params:Z,terminalEl:D1,shake:W5})}catch(q){if(console.error(q),typeof q==="object"&&q!==null&&("message"in q))X1(`Process exited with error: ${q.message}`)}O1.value=!0,o1.style.display=z}else X1(`Command not found: ${Q}`),X1("Type 'help' to list all available commands")};D1.addEventListener("keydown",async(_)=>{if(!O1.value)return;const J=L.value;if(_.keyCode===13){if(J.trim()==="")return;X1(`${N0.textContent} ${J}`),y.push(J),await X5(J),L.value=""}else if(_.keyCode===8)L.value=J.slice(0,-1);else if(_.key.length===1)L.value+=_.key;else if(_.keyCode===32)L.value+=" ";else if(_.keyCode===38)n=Math.min(y.length,n+1),L.value=y[y.length-n]||"";else if(_.keyCode===40)n=Math.max(0,n-1),L.value=y[y.length-n]||"";else if(_.keyCode===9){const Q=J.split(" ").pop();_.preventDefault();const Z=_0(Q);if(Z)L.value+=Z}});w1(()=>{N0.textContent=`amiran@${m.value}:${v.value} \$`});w1(()=>{j5.textContent=L.value});
